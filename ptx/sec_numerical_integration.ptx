

<section xml:id="sec_numerical_integration">
  <title>Numerical Integration</title>
  <introduction>
    <p>
      The Fundamental Theorem of Calculus gives a concrete technique for finding the exact value of a definite integral.
      That technique is based on computing antiderivatives.
      Despite the power of this theorem,
      there are still situations where we must <em>approximate</em>
      the value of the definite integral instead of finding its exact value.
      The first situation we explore is where we <em>cannot</em>
      compute the antiderivative of the integrand.
      The second case is when we actually do not know the function in the integrand,
      but only its value when evaluated at certain points.
          <idx><h>integration</h><h>numerical</h></idx>
          <idx><h>numerical integration</h></idx>
    </p>

    <p>
      An <em>elementary function</em>
          <idx><h>elementary function</h></idx>
      is any function that is a combination of polynomial,
      <m>n^{\text{ th } }</m> root, rational,
      exponential, logarithmic and trigonometric functions.
      We can compute the derivative of any elementary function,
      but there are many elementary functions of which we cannot compute an antiderivative.
      For example,
      the following functions do not have antiderivatives that we can express with elementary functions:
      <me>
        e^{-x^2},  \sin(x^3) \text{ and }   \frac{\sin x}{x}
      </me>.
    </p>

    <p>
      The simplest way to refer to the antiderivatives of
      <m>e^{-x^2}</m> is to simply write <m>\int e^{-x^2}\ dx</m>.
    </p>

    <p>
      This section outlines three common methods of approximating the value of definite integrals.
      We describe each as a systematic method of approximating area under a curve.
      By approximating this area accurately,
      we find an accurate approximation of the corresponding definite integral.
    </p>

    <p>
      We will apply the methods we learn in this section to the following definite integrals:
      <me>
        \int_0^1 e^{-x^2} \ dx,  \int_{-\frac{\pi}{4}}^{\frac{\pi}{2}} \sin(x^3) \ dx,  \text{ and }   \int_{0.5}^{4\pi} \frac{\sin(x)}{x} \ dx
      </me>,
      as pictured in <xref ref="fig_numerical1">Figure</xref>.
    </p>

    <figure xml:id="fig_numerical1">
      <caption>Graphically representing three definite integrals that cannot be evaluated using antiderivatives.</caption>
      <sidebyside>
        <figure>
          <caption>[10pt]
          (a)</caption>
          <img src="figures/fignumerical1a"/>
        </figure>

        <figure>
          <caption>[10pt]
          (b)</caption>
          <img src="figures/fignumerical1b"/>
        </figure>

        <figure>
          <caption>[10pt]
          (c)</caption>
          <img src="figures/fignumerical1c"/>
        </figure>
      </sidebyside>

    </figure>
  </introduction>

  <subsection>
    <title>The Left and Right Hand Rule Methods</title>
    <p>
      In <xref ref="sec_riemann">Section</xref>
      we addressed the problem of evaluating definite integrals by approximating the area under the curve using rectangles.
      We revisit those ideas here before introducing other methods of approximating definite integrals.
          <idx><h>numerical integration</h><h>Left/Right Hand Rule</h></idx>
          <idx><h>Right Hand Rule</h></idx>
          <idx><h>Left Hand Rule</h></idx>
          <idx><h>integration</h><h>numerical!Left/Right Hand Rule</h></idx>
    </p>

    <p>
      We start with a review of notation.
      Let <m>f</m> be a continuous function on the interval <m>[a,b]</m>.
      We wish to approximate <m>\ds \int_a^b f(x)\ dx</m>.
      We partition <m>[a,b]</m> into <m>n</m> equally spaced subintervals,
      each of length <m>\ds\dx = \frac{b-a}{n}</m>.
      The endpoints of these subintervals are labeled as
      <me>
        x_1=a,\ x_2 = a+\dx,\ x_3 = a+ 2\dx,\ \ldots,\ x_i = a+(i-1)\dx,\ \ldots,\ x_{n+1} = b
      </me>.
    </p>

    <p>
      <xref ref="idea_riemann">Key Idea</xref>
      states that to use the Left Hand Rule we use the summation
      <m>\ds \sum_{i=1}^n f(x_i)\dx</m> and to use the Right Hand Rule we use <m>\ds \sum_{i=1}^n f(x_{i+1})\dx</m>.
      We review the use of these rules in the context of examples.
    </p>

    <example xml:id="ex_num1">
      <title>Approximating definite integrals with rectangles</title>
      <statement>
        <p>
          Approximate <m>\ds \int_0^1e^{-x^2}\ dx</m> using the Left and Right Hand Rules with 5 equally spaced subintervals.
        </p>
      </statement>
      <solution>
        <p>
          We begin by partitioning the interval <m>[0,1]</m> into 5 equally spaced intervals.
          We have <m>\dx = \frac{1-0}5 = 1/5=0.2</m>, so
          <me>
            x_1 = 0,\ x_2 = 0.2,\ x_3 = 0.4,\ x_4 = 0.6,\ x_5 = 0.8,\ \text{ and } \ x_6 = 1
          </me>.
        </p>

        <p>
          Using the Left Hand Rule, we have:
          <md>
            <mrow>\sum_{i=1}^n f(x_i)\dx \amp = \big(f(x_1)+f(x_2) + f(x_3) + f(x_4) + f(x_5)\big)\dx</mrow>
            <mrow>\amp = \big(f(0) + f(0.2) + f(0.4) + f(0.6) + f(0.8)\big)\dx</mrow>
            <mrow>\amp \approx \big(1+0.961 + 0.852 + 0.698 + 0.527)(0.2)</mrow>
            <mrow>\amp \approx 0.808</mrow>
          </md>.
        </p>

        <p>
          Using the Right Hand Rule, we have:
          <md>
            <mrow>\sum_{i=1}^n f(x_{i+1})\dx \amp = \big(f(x_2) + f(x_3) + f(x_4) + f(x_5)+f(x_6)\big)\dx</mrow>
            <mrow>\amp = \big(f(0.2) + f(0.4) + f(0.6) + f(0.8)+f(1)\big)\dx</mrow>
            <mrow>\amp \approx \big(0.961 +0.852 + 0.698 + 0.527 + 0.368)(0.2)</mrow>
            <mrow>\amp \approx 0.681</mrow>
          </md>.
        </p>

        <figure xml:id="fig_num1">
          <caption>Approximating <m>\int_0^1e^{-x^2}\ dx</m> in <xref ref="ex_num1">Example</xref>.</caption>
          <sidebyside>
            <figure>
              <caption>[10pt]
              (a)</caption>
              <img src="figures/fignum1b"/>
            </figure>

            <figure>
              <caption>[10pt]
              (b)</caption>
              <img src="figures/fignum1a"/>
            </figure>
          </sidebyside>

        </figure>

        <p>
          <xref ref="fig_num1">Figure</xref>
          shows the rectangles used in each method to approximate the definite integral.
          These graphs show that in this particular case,
          the Left Hand Rule is an over approximation and the Right Hand Rule is an under approximation.
          To get a better approximation,
          we could use more rectangles,
          as we did in <xref ref="sec_riemann">Section</xref>.
          We could also average the Left and Right Hand Rule results together, giving
          <me>
            \frac{0.808 + 0.681}{2} = 0.7445
          </me>.
        </p>

        <p>
          The actual answer, accurate to 4 places after the decimal,
          is 0.7468, showing our average is a good approximation.
        </p>
      </solution>
    </example>

    <example xml:id="ex_num2">
      <title>Approximating definite integrals with rectangles</title>
      <statement>
        <p>
          Approximate <m>\ds\int_{-\frac{\pi}4}^{\frac{\pi}2} \sin (x^3)\ dx</m> using the Left and Right Hand Rules with 10 equally spaced subintervals.
        </p>
      </statement>
      <solution>
        <p>
          We begin by finding \Delta x:
          <me>
            \frac{b-a}{n} = \frac{\pi/2 - (-\pi/4)}{10} = \frac{3\pi}{40}\approx 0.236
          </me>.
        </p>

        <p>
          It is useful to write out the endpoints of the subintervals in a table;
          in <xref ref="fig_num2a">Figure</xref>,
          we give the exact values of the endpoints,
          their decimal approximations,
          and decimal approximations of
          <m>\sin(x^3)</m> evaluated at these points.
        </p>

        <table xml:id="fig_num2a">
          <caption>Table of values used to approximate <m>\int_{-\frac{\pi}4}^{\frac{\pi}2}\sin(x^3)\ dx</m> in <xref ref="ex_num2">Example</xref>.</caption>
          <tabular>
            <row>
              <cell><m>x_i</m></cell>
              <cell>Exact</cell>
              <cell>Approx.</cell>
              <cell><m>\sin(x_i^3)</m></cell>
            </row>
            <row bottom="minor">
              <cell></cell>
              <cell></cell>
              <cell></cell>
              <cell></cell>
            </row>
            <row>
              <cell><m>x_1</m></cell>
              <cell><m>-\pi/4</m></cell>
              <cell><m>-0.785</m></cell>
              <cell><m>-0.466</m></cell>
            </row>
            <row>
              <cell><m>x_2</m></cell>
              <cell><m>-7 \pi/40</m></cell>
              <cell><m>-0.550</m></cell>
              <cell><m>-0.165</m></cell>
            </row>
            <row>
              <cell><m>x_3</m></cell>
              <cell><m>-{\pi }/{10}</m></cell>
              <cell><m>-0.314</m></cell>
              <cell><m>-0.031</m></cell>
            </row>
            <row>
              <cell><m>x_4</m></cell>
              <cell><m>-{\pi }/{40}</m></cell>
              <cell><m>-0.0785</m></cell>
              <cell><m>0</m></cell>
            </row>
            <row>
              <cell><m>x_5</m></cell>
              <cell><m>{\pi }/{20}</m></cell>
              <cell>0.157</cell>
              <cell>0.004</cell>
            </row>
            <row>
              <cell><m>x_6</m></cell>
              <cell><m>{\pi }/{8}</m></cell>
              <cell>0.393</cell>
              <cell>0.061</cell>
            </row>
            <row>
              <cell><m>x_7</m></cell>
              <cell><m>{\pi }/{5}</m></cell>
              <cell>0.628</cell>
              <cell>0.246</cell>
            </row>
            <row>
              <cell><m>x_8</m></cell>
              <cell><m>{11 \pi }/{40}</m></cell>
              <cell>0.864</cell>
              <cell>0.601</cell>
            </row>
            <row>
              <cell><m>x_9</m></cell>
              <cell><m>{7 \pi }/{20}</m></cell>
              <cell>1.10</cell>
              <cell>0.971</cell>
            </row>
            <row>
              <cell><m>x_{10}</m></cell>
              <cell><m>{17 \pi }/{40}</m></cell>
              <cell>1.34</cell>
              <cell>0.690</cell>
            </row>
            <row>
              <cell><m>x_{11}</m></cell>
              <cell><m>{\pi }/{2}</m></cell>
              <cell>1.57</cell>
              <cell><m>-0.670</m></cell>
            </row>
          </tabular>

        </table>

        <p>
          Once this table is created,
          it is straightforward to approximate the definite integral using the Left and Right Hand Rules.
          (Note: the table itself is easy to create,
          especially with a standard spreadsheet program on a computer.
          The last two columns are all that are needed.)
          The Left Hand Rule sums the first 10 values of
          <m>\sin(x_i^3)</m> and multiplies the sum by <m>\dx</m>;
          the Right Hand Rule sums the last 10 values of
          <m>\sin(x_i^3)</m> and multiplies by <m>\dx</m>.
          Therefore we have:
        </p>

        <p>
          Left Hand Rule:
          <m>\ds \int_{-\frac{\pi}4}^{\frac{\pi}2}\sin(x^3)\ dx \approx (1.91)(0.236) = 0.451</m>.
        </p>

        <p>
          Right Hand Rule:
          <m>\ds \int_{-\frac{\pi}4}^{\frac{\pi}2}\sin(x^3)\ dx \approx (1.71)(0.236) = 0.404</m>.
        </p>

        <p>
          Average of the Left and Right Hand Rules: 0.4275.
        </p>

        <figure xml:id="fig_num2b">
          <caption>Approximating
          <m>\int_{-\frac{\pi}4}^{\frac{\pi}2}\sin(x^3)\ dx</m> in <xref ref="ex_num2">Example</xref>.</caption>
          <sidebyside>
            <figure>
              <caption>[10pt]
              (a)</caption>
              <img src="figures/fignum2b"/>
            </figure>

            <figure>
              <caption>[10pt]
              (b)</caption>
              <img src="figures/fignum2a"/>
            </figure>
          </sidebyside>

        </figure>

        <p>
          The actual answer, accurate to 3 places after the decimal,
          is 0.460.
          Our approximations were once again fairly good.
          The rectangles used in each approximation are shown in <xref ref="fig_num2b">Figure</xref>.
          It is clear from the graphs that using more rectangles
          (and hence, narrower rectangles)
          should result in a more accurate approximation.
        </p>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>The Trapezoidal Rule</title>
    <p>
      In <xref ref="ex_num1">Example</xref>
      we approximated the value of
      <m>\ds \int_0^1 e^{-x^2}\ dx</m> with 5 rectangles of equal width.
      <xref ref="fig_num1">Figure</xref>
      shows the rectangles used in the Left and Right Hand Rules.
      These graphs clearly show that rectangles do not match the shape of the graph all that well,
      and that accurate approximations will only come by using lots of rectangles.
          <idx><h>Trapezoidal Rule</h></idx>
          <idx><h>numerical integration</h><h>Trapezoidal Rule</h></idx>
          <idx><h>integration</h><h>numerical!Trapezoidal Rule</h></idx>
    </p>

    <p>
      Instead of using rectangles to approximate the area,
      we can instead use <em>trapezoids.</em>
      In <xref ref="fig_num3a">Figure</xref>,
      we show the region under <m>f(x) = e^{-x^2}</m> on <m>[0,1]</m> approximated with 5 trapezoids of equal width;
      the top <q>corners</q> of each trapezoid lies on the graph of <m>f(x)</m>.
      It is clear from this figure that these trapezoids more accurately approximate the area under <m>f</m> and hence should give a better approximation of <m>\int_0^1 e^{-x^2}\ dx</m>. (In fact,
      these trapezoids seem to give a <em>great</em>
      approximation of the area!)
    </p>

    <figure xml:id="fig_num3a">
      <caption>Approximating <m>\int_0^1 e^{-x^2}\ dx</m> using 5 trapezoids of equal widths.</caption>
      <img src="figures/fignum3a"/>
    </figure>

    <p>
      The formula for the area of a trapezoid is given in <xref ref="fig_trapezoid">Figure</xref>.
      We approximate <m>\int_0^1 e^{-x^2}\ dx</m> with these trapezoids in the following example.
    </p>

    <example xml:id="ex_num3">
      <title>Approximating definite integrals using trapezoids</title>
      <statement>
        <p>
          Use 5 trapezoids of equal width to approximate <m>\ds \int_0^1e^{-x^2}\ dx</m>.
        </p>
      </statement>
      <solution>
        <p>
          To compute the areas of the 5 trapezoids in <xref ref="fig_num3a">Figure</xref>,
          it will again be useful to create a table of values as shown in <xref ref="fig_num3b">Figure</xref>.
        </p>

        <figure xml:id="fig_trapezoid">
          <caption>The area of a trapezoid.</caption>
          <img src="figures/figtrapezoid"/>
        </figure>

        <table xml:id="fig_num3b">
          <caption>A table of values of <m>e^{-x^2}</m>.</caption>
          <tabular>
            <row>
              <cell><m>x_i</m></cell>
              <cell><m>e^{-x_i^2}</m></cell>
            </row>
            <row bottom="minor">
              <cell></cell>
              <cell></cell>
            </row>
            <row>
              <cell>0</cell>
              <cell>1</cell>
            </row>
            <row>
              <cell>0.2</cell>
              <cell>0.961</cell>
            </row>
            <row>
              <cell>0.4</cell>
              <cell>0.852</cell>
            </row>
            <row>
              <cell>0.6</cell>
              <cell>0.698</cell>
            </row>
            <row>
              <cell>0.8</cell>
              <cell>0.527</cell>
            </row>
            <row>
              <cell>1</cell>
              <cell>0.368</cell>
            </row>
          </tabular>

        </table>

        <p>
          The leftmost trapezoid has legs of length 1 and 0.961 and a height of 0.2.
          Thus, by our formula, the area of the leftmost trapezoid is:
          <me>
            \frac{1+0.961}{2}(0.2) = 0.1961
          </me>.
        </p>

        <p>
          Moving right,
          the next trapezoid has legs of length 0.961 and 0.852 and a height of 0.2.
          Thus its area is:
          <me>
            \frac{0.961+0.852}2(0.2) = 0.1813
          </me>.
        </p>

        <p>
          The sum of the areas of all 5 trapezoids is:
          <md>
            <mrow>\frac{1+0.961}{2}(0.2) + \frac{0.961+0.852}2(0.2)+\frac{0.852+0.698}2(0.2)\amp +</mrow>
            <mrow>\frac{0.698+0.527}2(0.2)+\frac{0.527+0.368}2(0.2)\amp = 0.7445</mrow>
          </md>.
        </p>

        <p>
          We approximate <m>\ds \int_0^1 e^{-x^2}\ dx \approx 0.7445</m>.
        </p>
      </solution>
    </example>

    <p>
      There are many things to observe in this example.
      Note how each term in the final summation was multiplied by both 1/2 and by <m>\dx = 0.2</m>.
      We can factor these coefficients out,
      leaving a more concise summation as:
      <me>
        \frac12(0.2)\Big[(1+0.961) + (0.961+0.852) + (0.852+0.698) + ( 0.698+ 0.527) +(0.527 + 0.368)\Big]
      </me>.
    </p>

    <p>
      Now notice that all numbers except for the first and the last are added twice.
      Therefore we can write the summation even more concisely as
      <me>
        \frac{0.2}{2}\Big[1 + 2(0.961+0.852+0.698+0.527) + 0.368\Big]
      </me>.
    </p>

    <p>
      This is the heart of the <em>Trapezoidal Rule</em>,
      wherein a definite integral
      <m>\ds \int_a^b f(x) \ dx</m> is approximated by using trapezoids of equal widths to approximate the corresponding area under <m>f</m>.
      Using <m>n</m> equally spaced subintervals with endpoints <m>x_1</m>,
      <m>x_2</m>,
      <m>\ldots</m>, <m>x_{n+1}</m>,
      we again have <m>\ds \dx = \frac{b-a}n</m>.
      Thus:
      <md>
        <mrow>\int_a^b f(x)\ dx \amp  \approx \sum_{i=1}^n \frac{f(x_i)+f(x_{i+1})}2\dx</mrow>
        <mrow>\amp  = \frac{\dx}2 \sum_{i=1}^n \big(f(x_i)+f(x_{i+1})\big)</mrow>
        <mrow>\amp  = \frac{\dx}2\Big[f(x_1)+ 2\sum_{i=2}^n f(x_i) + f(x_{n+1})\Big]</mrow>
      </md>.
    </p>

    <example xml:id="ex_num4">
      <title>Using the Trapezoidal Rule</title>
      <statement>
        <p>
          Revisit <xref ref="ex_num2">Example</xref>
          and approximate <m>\ds\int_{-\frac{\pi}{4}}^{\frac{\pi}{2}} \sin (x^3)\ dx</m> using the Trapezoidal Rule and 10 equally spaced subintervals.
        </p>
      </statement>
      <solution>
        <p>
          We refer back to <xref ref="fig_num2a">Figure</xref>
          for the table of values of <m>\sin(x^3)</m>.
          Recall that <m>\dx = 3\pi/40 \approx 0.236</m>.
          Thus we have:
          <md>
            <mrow>\int_{-\frac{\pi}4}^{\frac{\pi}2} \sin (x^3)\ dx \amp \approx \frac{0.236}{2}\Big[-0.466 + 2\Big(-0.165+(-0.031)+\ldots+
            0.69\Big)+(-0.67)\Big]</mrow>
            <mrow>\amp = 0.4275</mrow>
          </md>.
        </p>
      </solution>
    </example>

    <p>
      Notice how <q>quickly</q> the Trapezoidal Rule can be implemented once the table of values is created.
      This is true for all the methods explored in this section;
      the real work is creating a table of <m>x_i</m> and <m>f(x_i)</m> values.
      Once this is completed,
      approximating the definite integral is not difficult.
      Again, using technology is wise.
      Spreadsheets can make quick work of these computations and make using lots of subintervals easy.
    </p>

    <p>
      Also notice the approximations the Trapezoidal Rule gives.
      It is the average of the approximations given by the Left and Right Hand Rules!
      This effectively renders the Left and Right Hand Rules obsolete.
      They are useful when first learning about definite integrals,
      but if a real approximation is needed,
      one is generally better off using the Trapezoidal Rule instead of either the Left or Right Hand Rule.
    </p>

    <p>
      How can we improve on the Trapezoidal Rule,
      apart from using more and more trapezoids?
      The answer is clear once we look back and consider what we have
      <em>really</em> done so far.
      The Left Hand Rule is not <em>really</em>
      about using rectangles to approximate area.
      Instead, it approximates a function <m>f</m> with constant functions on small subintervals and then computes the definite integral of these constant functions.
      The Trapezoidal Rule is really approximating a function <m>f</m> with a linear function on a small subinterval,
      then computes the definite integral of this linear function.
      In both of these cases the definite integrals are easy to compute in geometric terms.
    </p>

    <p>
      So we have a progression:
      we start by approximating <m>f</m> with a constant function and then with a linear function.
      What is next?
      A quadratic function.
      By approximating the curve of a function with lots of parabolas,
      we generally get an even better approximation of the definite integral.
      We call this process <em>Simpson's Rule</em>,
      named after Thomas Simpson (1710-1761),
      even though others had used this rule as much as 100 years prior.
    </p>
  </subsection>

  <subsection>
    <title>Simpson's Rule</title>
    <p>
      Given one point,
      we can create a constant function that goes through that point.
      Given two points,
      we can create a linear function that goes through those points.
      Given three points,
      we can create a quadratic function that goes through those three points
      (given that no two have the same <m>x</m><ndash />value).
          <idx><h>Simpson's Rule</h></idx>
          <idx><h>numerical integration</h><h>Simpson's Rule</h></idx>
          <idx><h>integration</h><h>numerical!Simpson's Rule</h></idx>
    </p>

    <p>
      Consider three points <m>(x_1,y_1)</m>,
      <m>(x_2,y_2)</m> and <m>(x_3,y_3)</m> whose <m>x</m><ndash />values are equally spaced and <m>x_1\lt x_2\lt x_3</m>.
      Let <m>f</m> be the quadratic function that goes through these three points.
      It is not hard to show that
      <men xml:id="eq_simpsons">
        \int_{x_1}^{x_3} f(x)\ dx = \frac{x_3-x_1}{6}\big(y_1+4y_2+y_3\big)
      </men>.
    </p>

    <p>
      Consider <xref ref="fig_numsimpsons">Figure</xref>.
      A function <m>f</m> goes through the 3 points shown and the parabola <m>g</m> that also goes through those points is graphed with a dashed line.
      Using our equation from above, we know exactly that
      <me>
        \int_1^3 g(x) \ dx = \frac{3-1}{6}\big(3+4(1)+2\big)= 3
      </me>.
    </p>

    <p>
      Since <m>g</m> is a good approximation for <m>f</m> on <m>[1,3]</m>,
      we can state that
      <me>
        \int_1^3 f(x)\ dx \approx 3
      </me>.
    </p>

    <figure xml:id="fig_numsimpsons">
      <caption>A graph of a function <m>f</m> and a parabola that approximates it well on <m>[1,3]</m>.</caption>
      <img src="figures/fignumsimpsons"/>
    </figure>

    <p>
      Notice how the interval <m>[1,3]</m> was split into two subintervals as we needed 3 points.
      Because of this, whenever we use Simpson's Rule,
      we need to break the interval into an even number of subintervals.
    </p>

    <p>
      In general, to approximate
      <m>\ds \int_a^b f(x)\ dx</m> using Simpson's Rule,
      subdivide <m>[a,b]</m> into <m>n</m> subintervals,
      where <m>n</m> is even and each subinterval has width <m>\dx = (b-a)/n</m>.
      We approximate <m>f</m> with <m>n/2</m> parabolic curves,
      using Equation <xref ref="eq_simpsons" /> to compute the area under these parabolas.
      Adding up these areas gives the formula:
      <me>
        \int_a^b f(x) \ dx \approx \frac{\dx}3\Big[f(x_1)+4f(x_2)+2f(x_3)+4f(x_4)+\ldots+2f(x_{n-1})+4f(x_n)+f(x_{n+1})\Big]
      </me>.
    </p>

    <p>
      Note how the coefficients of the terms in the summation have the pattern 1, 4, 2, 4, 2, 4, <m>\ldots</m>, 2, 4, 1.
    </p>

    <p>
      Let's demonstrate Simpson's Rule with a concrete example.
    </p>

    <example xml:id="ex_num5">
      <title>Using Simpson's Rule</title>
      <statement>
        <p>
          Approximate <m>\ds\int_0^1 e^{-x^2}\ dx</m> using Simpson's Rule and 4 equally spaced subintervals.
        </p>
      </statement>
      <solution>
        <p>
          We begin by making a table of values as we have in the past,
          as shown in <xref ref="fig_num5a">Figure</xref>(a).
        </p>

        <table xml:id="fig_num5a">
          <caption>A table of values to approximate <m>\int_0^1e^{-x^2}\ dx</m>, along with a graph of the function.</caption>
          <tabular>
          <row>
          <cell><tabular>
            <row>
              <cell><m>x_i</m></cell>
              <cell><m>e^{-x_i^2}</m></cell>
            </row>
            <row bottom="minor">
              <cell></cell>
              <cell></cell>
            </row>
            <row>
              <cell>0</cell>
              <cell>1</cell>
            </row>
            <row>
              <cell>0.25</cell>
              <cell>0.939</cell>
            </row>
            <row>
              <cell>0.5</cell>
              <cell>0.779</cell>
            </row>
            <row>
              <cell>0.75</cell>
              <cell>0.570</cell>
            </row>
            <row>
              <cell>1</cell>
              <cell>0.368</cell>
            </row>
          </tabular></cell>
          </row>
          <row>
            <cell>(a)</cell>
          </row>
          <row>
            <cell><img src="figures/fignum5b"/></cell>
          </row>
          <row>
            <cell>(b)</cell>
          </row>
          </tabular>

        </table>

        <p>
          Simpson's Rule states that
          <me>
            \int_0^1e^{-x^2}\ dx \approx \frac{0.25}{3}\Big[1+4(0.939)+2(0.779)+4(0.570) + 0.368\Big] = 0.7468\overline{3}
          </me>.
        </p>

        <p>
          Recall in <xref ref="ex_num1">Example</xref>
          we stated that the correct answer,
          accurate to 4 places after the decimal, was 0.7468.
          Our approximation with Simpson's Rule, with 4 subintervals,
          is better than our approximation with the Trapezoidal Rule using 5!
        </p>

        <p>
          <xref ref="fig_num5a">Figure</xref>(b) shows
          <m>f(x) = e^{-x^2}</m> along with its approximating parabolas,
          demonstrating how good our approximation is.
          The approximating curves are nearly indistinguishable from the actual function.
        </p>
      </solution>
    </example>

    <example xml:id="ex_num6">
      <title>Using Simpson's Rule</title>
      <statement>
        <p>
          Approximate <m>\ds\int_{-\frac{\pi}4}^{\frac{\pi}2} \sin (x^3)\ dx</m> using Simpson's Rule and 10 equally spaced intervals.
        </p>
      </statement>
      <solution>
        <p>
          <xref ref="fig_num6a">Figure</xref>
          shows the table of values that we used in the past for this problem,
          shown here again for convenience.
          Again, <m>\dx = (\pi/2+\pi/4)/10 \approx 0.236</m>.
        </p>

        <table xml:id="fig_num6a">
          <caption>Table of values used to approximate <m>\int_{-\frac{\pi}4}^{\frac{\pi}2}\sin(x^3)\ dx</m> in <xref ref="ex_num6">Example</xref>.</caption>
          <tabular>
            <row>
              <cell><m>x_i</m></cell>
              <cell><m>\sin(x_i^3)</m></cell>
            </row>
            <row bottom="minor">
              <cell></cell>
              <cell></cell>
            </row>
            <row>
              <cell><m>-0.785</m></cell>
              <cell><m>-0.466</m></cell>
            </row>
            <row>
              <cell><m>-0.550</m></cell>
              <cell><m>-0.165</m></cell>
            </row>
            <row>
              <cell><m>-0.314</m></cell>
              <cell><m>-0.031</m></cell>
            </row>
            <row>
              <cell><m>-0.0785</m></cell>
              <cell><m>0</m></cell>
            </row>
            <row>
              <cell>0.157</cell>
              <cell>0.004</cell>
            </row>
            <row>
              <cell>0.393</cell>
              <cell>0.061</cell>
            </row>
            <row>
              <cell>0.628</cell>
              <cell>0.246</cell>
            </row>
            <row>
              <cell>0.864</cell>
              <cell>0.601</cell>
            </row>
            <row>
              <cell>1.10</cell>
              <cell>0.971</cell>
            </row>
            <row>
              <cell>1.34</cell>
              <cell>0.690</cell>
            </row>
            <row>
              <cell>1.57</cell>
              <cell><m>-0.670</m></cell>
            </row>
          </tabular>

        </table>

        <p>
          Simpson's Rule states that
          <md>
            <mrow>\int_{-\frac{\pi}4}^{\frac{\pi}2} \sin (x^3)\ dx \amp \approx \frac{0.236}3\Big[(-0.466)+4(-0.165)+2(-0.031) + \ldots</mrow>
            <mrow>\amp  \ldots + 2(0.971) + 4(0.69) + (-0.67)\big]</mrow>
            <mrow>\amp = 0.4701</mrow>
          </md>
        </p>

        <figure xml:id="fig_num6b">
          <caption>Approximating <m>\int_{-\frac{\pi}4}^{\frac{\pi}2}\sin(x^3)\ dx</m> in <xref ref="ex_num6">Example</xref> with Simpson's Rule and 10 equally spaced intervals.</caption>
          <img src="figures/fignum6b"/>
        </figure>

        <p>
          Recall that the actual value,
          accurate to 3 decimal places, is 0.460.
          Our approximation is within one 1/100<m>^\text{ th }</m> of the correct value.
          The graph in <xref ref="fig_num6b">Figure</xref>
          shows how closely the parabolas match the shape of the graph.
        </p>
      </solution>
    </example>
  </subsection>

  <subsection>
    <title>Summary and Error Analysis</title>
    <p>
      We summarize the key concepts of this section thus far in the following Key Idea.
    </p>

    <sidebyside>

      <insight xml:id="idea_numerical">
        <title>Numerical Integration</title>
        <p>
          Let <m>f</m> be a continuous function on <m>[a,b]</m>,
          let <m>n</m> be a positive integer,
          and let <m>\ds\dx = \frac{b-a}{n}</m>.
              <idx><h>integration</h><h>numerical!Left/Right Hand Rule</h></idx>
              <idx><h>integration</h><h>numerical!Trapezoidal Rule</h></idx>
              <idx><h>integration</h><h>numerical!Simpson's Rule</h></idx>
              <idx><h>Left/Right Hand Rule</h></idx>
              <idx><h>Trapezoidal Rule</h></idx>
              <idx><h>Simpson's Rule</h></idx>
              <idx><h>numerical integration</h><h>Left/Right Hand Rule</h></idx>
              <idx><h>numerical integration</h><h>Trapezoidal Rule</h></idx>
              <idx><h>numerical integration</h><h>Simpson's Rule</h></idx>
        </p>

        <p>
          Set <m>x_1=a</m>, <m>x_2 = a+\dx</m>,
          <m>\ldots</m>, <m>x_i = a+(i-1)\dx</m>, <m>x_{n+1}=b</m>.
        </p>

        <p>
          Consider <m>\ds\int_a^b f(x)\ dx</m>.
        </p>

        <p>
          Left Hand Rule:
          <m>\ds\int_a^b f(x)\ dx \approx \dx\Big[f(x_1) + f(x_2) + \ldots + f(x_n)\big]</m>.
        </p>

        <p>
          Right Hand Rule:
          <m>\ds\int_a^b f(x)\ dx \approx \dx\Big[f(x_2) + f(x_3) + \ldots + f(x_{n+1})\big]</m>.
        </p>

        <p>
          Trapezoidal Rule:
          <m>\ds\int_a^b f(x)\ dx \approx \frac{\dx}2\Big[f(x_1) + 2f(x_2) + 2f(x_3) +\ldots + 2f(x_n)+ f(x_{n+1})\big]</m>.
        </p>

        <p>
          Simpson's Rule:
          <m>\ds\int_a^b f(x)\ dx \approx \frac{\dx}3\Big[f(x_1) + 4f(x_2) + 2f(x_3) +\ldots + 4f(x_n)+ f(x_{n+1})\big]</m> { (<m>n</m> even)}.
        </p>
      </insight>

    </sidebyside>

    <p>
      In our examples,
      we approximated the value of a definite integral using a given method then compared it to the <q>right</q> answer.
      This should have raised several questions in the reader's mind, such as:

      <ol>
        <li>
          <p>
            How was the <q>right</q> answer computed?
          </p>
        </li>

        <li>
          <p>
            If the right answer can be found,
            what is the point of approximating?
          </p>
        </li>

        <li>
          <p>
            If there is value to approximating,
            how are we supposed to know if the approximation is any good?
          </p>
        </li>
      </ol>
    </p>

    <p>
      These are good questions, and their answers are educational.
      In the examples, <em>the</em> right answer was never computed.
      Rather, an approximation accurate to a certain number of places after the decimal was given.
      In <xref ref="ex_num1">Example</xref>,
      we do not know the <em>exact</em> answer,
      but we know it starts with 0.7468.
      These more accurate approximations were computed using numerical integration but with more precision (i.e., more subintervals and the help of a computer).
    </p>

    <p>
      Since the exact answer cannot be found,
      approximation still has its place.
      How are we to tell if the approximation is any good?
    </p>

    <p>
      <q>Trial and error</q> provides one way.
      Using technology, make an approximation with,
      say, 10, 100, and 200 subintervals.
      This likely will not take much time at all,
      and a trend should emerge.
      If a trend does not emerge, try using yet more subintervals.
      Keep in mind that trial and error is never foolproof;
      you might stumble upon a problem in which a trend will not emerge.
    </p>

    <p>
      A second method is to use Error Analysis.
      While the details are beyond the scope of this text,
      there are some formulas that give <em>bounds</em>
      for how good your approximation will be.
      For instance,
      the formula might state that the approximation is within 0.1 of the correct answer.
      If the approximation is 1.58,
      then one knows that the correct answer is between 1.48 and 1.68.
      By using lots of subintervals,
      one can get an approximation as accurate as one likes.
      <xref ref="thm_numerical_error">Theorem</xref> states what these bounds are.
    </p>

    <theorem xml:id="thm_numerical_error">
      <title>Error Bounds in the Trapezoidal Rule and Simpson's Rule</title>
      <statement>
        <ol>
          <idx><h>integration</h><h>numerical!Trapezoidal Rule</h></idx>
          <idx><h>integration</h><h>numerical!Simpson's Rule</h></idx>
          <idx><h>Trapezoidal Rule</h><h>error bounds</h></idx>
          <idx><h>Simpson's Rule</h><h>error bounds</h></idx>
          <idx><h>numerical integration</h><h>Trapezoidal Rule!error bounds</h></idx>
          <idx><h>numerical integration</h><h>Simpson's Rule!error bounds</h></idx>

          <li>
            <p>
              Let <m>E_T</m> be the error in approximating
              <m>\ds \int_a^b f(x)\ dx</m> using the Trapezoidal Rule with <m>n</m> subintervals. 

              If <m>f</m> has a continuous 2<m>^\text{ nd }</m> derivative on <m>[a,b]</m> and <m>M</m> is any upper bound of
              <m>\big|\fpp(x)\big|</m> on <m>[a,b]</m>, then
              <me>
                \ds E_T \leq \frac{(b-a)^3}{12n^2}M
              </me>.
            </p>
          </li>

          <li>
            <p>
              Let <m>E_S</m> be the error in approximating
              <m>\ds \int_a^b f(x)\ dx</m> using Simpson's Rule  with <m>n</m> subintervals. 

              If <m>f</m> has a continuous 4<m>^\text{ th }</m> derivative on <m>[a,b]</m> and <m>M</m> is any upper bound of
              <m>\big|f\,^{(4)}\big|</m> on <m>[a,b]</m>, then
              <me>
                E_S \leq \frac{(b-a)^5}{180n^4}M
              </me>.
            </p>
          </li>
        </ol>
      </statement>
    </theorem>

    <p>
      There are some key things to note about this theorem.

      <ol>
        <li>
          <p>
            The larger the interval, the larger the error.
            This should make sense intuitively.
          </p>
        </li>

        <li>
          <p>
            The error shrinks as more subintervals are used (i.e., as <m>n</m> gets larger).
          </p>
        </li>

        <li>
          <p>
            The error in Simpson's Rule has a term relating to the 4<m>^{\text{ th } }</m> derivative of <m>f</m>.
            Consider a cubic polynomial:
            it's <m>4^{\text{ th } }</m> derivative is 0.
            Therefore, the error in approximating the definite integral of a cubic polynomial with Simpson's Rule is 0 <mdash /> Simpson's Rule computes the exact answer!
          </p>
        </li>
      </ol>
    </p>

    <p>
      We revisit <xref ref="ex_num3">Examples</xref>
      and <xref ref="ex_num5"></xref>
      and compute the error bounds using <xref ref="thm_numerical_error">Theorem</xref> in the following example.
    </p>

    <example xml:id="ex_num7">
      <title>Computing error bounds</title>
      <statement>
        <p>
          Find the error bounds when approximating
          <m>\ds \int_0^1 e^{-x^2}\ dx</m> using the Trapezoidal Rule and 5 subintervals,
          and using Simpson's Rule with 4 subintervals.
        </p>
      </statement>
      <solution>
        <p>
          <em>Trapezoidal Rule with <m>n=5</m>:</em>
        </p>

        <figure xml:id="fig_num7a">
          <caption>Graphing <m>\fpp(x)</m> in <xref ref="ex_num7">Example</xref> to help establish error bounds.</caption>
          <img src="figures/fignum7a"/>
        </figure>

        <p>
          We start by computing the <m>2^\text{ nd }</m> derivative of <m>f(x) = e^{-x^2}</m>:
          <me>
            \fpp(x) = e^{-x^2}(4x^2-2)
          </me>.
        </p>

        <p>
          <xref ref="fig_num7a">Figure</xref>
          shows a graph of <m>\fpp(x)</m> on <m>[0,1]</m>.
          It is clear that the largest value of <m>\fpp</m>, in absolute value, is 2.
          Thus we let <m>M=2</m> and apply the error formula from <xref ref="thm_numerical_error">Theorem</xref>.
          <me>
            E_T = \frac{(1-0)^3}{12\cdot 5^2}\cdot 2 = 0.00\overline{6}
          </me>.
        </p>

        <p>
          Our error estimation formula states that our approximation of 0.7445 found in <xref ref="ex_num3">Example</xref>
          is within 0.0067 of the correct answer, hence we know that
          <me>
            0.7445-0.0067 = .7378 \leq \int_0^1e^{-x^2}\ dx \leq 0.7512 = 0.7445 + 0.0067
          </me>.
        </p>

        <p>
          We had earlier computed the exact answer,
          correct to 4 decimal places, to be 0.7468,
          affirming the validity of <xref ref="thm_numerical_error">Theorem</xref>.
        </p>

        <p>
          <em>Simpson's Rule with <m>n=4</m>:</em>
        </p>

        <p>
          We start by computing the <m>4^\text{ th }</m> derivative of <m>f(x) = e^{-x^2}</m>:
          <me>
            f\,^{(4)}(x) = e^{-x^2}(16x^4-48x^2+12)
          </me>.
        </p>

        <p>
          <xref ref="fig_num7b">Figure</xref>
          shows a graph of <m>f\,^{(4)}(x)</m> on <m>[0,1]</m>.
          It is clear that the largest value of
          <m>f\,^{(4)}</m>, in absolute value, is 12.
          Thus we let <m>M=12</m> and apply the error formula from <xref ref="thm_numerical_error">Theorem</xref>.
          <me>
            E_s = \frac{(1-0)^5}{180\cdot 4^4}\cdot 12 = 0.00026
          </me>.
        </p>

        <figure xml:id="fig_num7b">
          <caption>Graphing <m>f\ ^{(4)}(x)</m> in <xref ref="ex_num7">Example</xref> to help establish error bounds.</caption>
          <img src="figures/fignum7b"/>
        </figure>

        <p>
          Our error estimation formula states that our approximation of
          <m>0.7468\overline{3}</m> found in <xref ref="ex_num5">Example</xref>
          is within 0.00026 of the correct answer, hence we know that
          <me>
            0.74683-0.00026 = .74657 \leq \int_0^1e^{-x^2}\ dx \leq 0.74709 = 0.74683 + 0.00026
          </me>.
        </p>

        <p>
          Once again we affirm the validity of <xref ref="thm_numerical_error">Theorem</xref>.
        </p>
      </solution>
    </example>

    <p>
      At the beginning of this section we mentioned two main situations where numerical integration was desirable.
      We have considered the case where an antiderivative of the integrand cannot be computed.
      We now investigate the situation where the integrand is not known.
      This is, in fact,
      the most widely used application of Numerical Integration methods.
      <q>Most of the time</q> we observe behavior but do not know <q>the</q>
      function that describes it.
      We instead collect data about the behavior and make approximations based on this data.
      We demonstrate this in an example.
    </p>

    <example xml:id="ex_num8">
      <title>Approximating distance traveled</title>
      <statement>
        <p>
          One of the authors drove his daughter home from school while she recorded their speed every 30 seconds.
          The data is given in <xref ref="fig_num8">Figure</xref>.
          Approximate the distance they traveled.
        </p>
      </statement>
      <solution>
        <p>
          Recall that by integrating a speed function we get distance traveled.
          We have information about <m>v(t)</m>;
          we will use Simpson's Rule to approximate <m>\ds \int_a^b v(t)\ dt</m>.
        </p>

        <p>
          The most difficult aspect of this problem is converting the given data into the form we need it to be in.
          The speed is measured in miles per hour,
          whereas the time is measured in minutes.
        </p>

        <table xml:id="fig_num8">
          <caption>Speed data collected at 30 second intervals for <xref ref="ex_num8">Example</xref>.</caption>
          <tabular>
            <row>
              <cell>Time</cell>
            </row>
            <row>
              <cell>(min)</cell>
              <cell>Speed</cell>
            </row>
            <row>
              <cell>(mph)</cell>
            </row>
            <row bottom="minor">
              <cell></cell>
              <cell></cell>
            </row>
            <row>
              <cell>0</cell>
              <cell>0</cell>
            </row>
            <row>
              <cell>0.5</cell>
              <cell>25</cell>
            </row>
            <row>
              <cell>1</cell>
              <cell>22</cell>
            </row>
            <row>
              <cell>1.5</cell>
              <cell>19</cell>
            </row>
            <row>
              <cell>2</cell>
              <cell>39</cell>
            </row>
            <row>
              <cell>2.5</cell>
              <cell>0</cell>
            </row>
            <row>
              <cell>3</cell>
              <cell>43</cell>
            </row>
            <row>
              <cell>3.5</cell>
              <cell>59</cell>
            </row>
            <row>
              <cell>4</cell>
              <cell>54</cell>
            </row>
            <row>
              <cell>4.5</cell>
              <cell>51</cell>
            </row>
            <row>
              <cell>5</cell>
              <cell>43</cell>
            </row>
            <row>
              <cell>5.5</cell>
              <cell>35</cell>
            </row>
            <row>
              <cell>6</cell>
              <cell>40</cell>
            </row>
            <row>
              <cell>6.5</cell>
              <cell>43</cell>
            </row>
            <row>
              <cell>7</cell>
              <cell>30</cell>
            </row>
            <row>
              <cell>7.5</cell>
              <cell>0</cell>
            </row>
            <row>
              <cell>8</cell>
              <cell>0</cell>
            </row>
            <row>
              <cell>8.5</cell>
              <cell>28</cell>
            </row>
            <row>
              <cell>9</cell>
              <cell>40</cell>
            </row>
            <row>
              <cell>9.5</cell>
              <cell>42</cell>
            </row>
            <row>
              <cell>10</cell>
              <cell>40</cell>
            </row>
            <row>
              <cell>10.5</cell>
              <cell>39</cell>
            </row>
            <row>
              <cell>11</cell>
              <cell>40</cell>
            </row>
            <row>
              <cell>11.5</cell>
              <cell>23</cell>
            </row>
            <row>
              <cell>12</cell>
              <cell>0</cell>
            </row>
          </tabular>

        </table>

        <p>
          We need to compute <m>\dx = (b-a)/n</m>.
          With 25 data points collected,
          there are <m>n=24</m> subintervals.
          What are <m>a</m> and <m>b</m>?
          Since we start at time <m>t=0</m>, we have <m>a=0</m>.
          The final recorded time was <m>t=12</m> minutes, which is 1/5 of an hour.
          Thus we have
          <me>
            \dx = \frac{b-a}{n} = \frac{1/5-0}{24} = \frac1{120};  \frac{\dx}{3} = \frac{1}{360}
          </me>.
        </p>

        <p>
          Thus the distance traveled is approximately:
          <md>
            <mrow>\int_0^{0.2}v(t)\ dt \amp \approx \frac{1}{360}\Big[f(x_1)+4f(x_2) + 2f(x_3) + \cdots + 4f(x_n)+f(x_{n+1})\Big]</mrow>
            <mrow>\amp = \frac{1}{360}\Big[0+4\cdot25+2\cdot 22 + \cdots + 2\cdot40+4\cdot 23 + 0\Big]</mrow>
            <mrow>\amp \approx 6.2167 \ \text{ miles. }</mrow>
          </md>
        </p>

        <p>
          We approximate the author drove 6.2 miles.
          (Because we are sure the reader wants to know,
          the author's odometer recorded the distance as about 6.05 miles.)
        </p>
      </solution>
    </example>

    <p>
      We started this chapter learning about antiderivatives and indefinite integrals.
      We then seemed to change focus by looking at areas between the graph of a function and the <m>x</m>-axis.
      We defined these areas as the definite integral of the function,
      using a notation very similar to the notation of the indefinite integral.
      The Fundamental Theorem of Calculus tied these two seemingly separate concepts together:
      we can find areas under a curve,
      i.e., we can evaluate a definite integral, using antiderivatives.
    </p>

    <p>
      We ended the chapter by noting that antiderivatives are sometimes more than difficult to find:
      they are impossible.
      Therefore we developed numerical techniques that gave us good approximations of definite integrals.
    </p>

    <p>
      We used the definite integral to compute areas,
      and also to compute displacements and distances traveled.
      There is far more we can do than that.
      In <xref ref="chapter_app_of_int">Chapter</xref>
      we'll see more applications of the definite integral.
      Before that, in <xref ref="chapter_anti_tech">Chapter</xref>
      we'll learn advanced techniques of integration,
      analogous to learning rules like the Product, Quotient and Chain Rules of differentiation.
    </p>
  </subsection>

  <subsection>
    <title>Terms and Concepts</title>
    <exercise>
      <statement>
        <p>
          T/F: Simpson's Rule is a method of approximating antiderivatives.
        </p>
      </statement>
      <answer>
        <p>
          F
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          What are the two basic situations where approximating the value of a definite integral is necessary?
        </p>
      </statement>
      <answer>
        <p>
          When the antiderivative cannot be computed and when the integrand is unknown.
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          Why are the Left and Right Hand Rules rarely used?
        </p>
      </statement>
      <answer>
        <p>
          They are superseded by the Trapezoidal Rule;
          it takes an equal amount of work and is generally more accurate.
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          Simpson's Rule is based on approximating portions of a function with what type of function?
        </p>
      </statement>
      <answer>
        <p>
          A quadratic function (i.e., parabola)
        </p>
      </answer>
    </exercise>
  </subsection>

  <subsection>
    <title>Problems</title>
    <p>
      In the following exercises, a definite integral is given.

      <ol>
        <li>
          <title>(a)</title>
          <p>
            Approximate the definite integral with the Trapezoidal Rule and <m>n=4</m>.
          </p>
        </li>

        <li>
          <title>(b)</title>
          <p>
            Approximate the definite integral with Simpson's Rule and <m>n=4</m>.
          </p>
        </li>

        <li>
          <title>(c)</title>
          <p>
            Find the exact value of the integral.
          </p>
        </li>
      </ol>
    </p>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{-1}^1 x^2\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>3/4</m>
            </p>
          </li>

          <li>
            <p>
              <m>2/3</m>
            </p>
          </li>

          <li>
            <p>
              <m>2/3</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{10} 5x\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>250</m>
            </p>
          </li>

          <li>
            <p>
              <m>250</m>
            </p>
          </li>

          <li>
            <p>
              <m>250</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{\pi} \sin x\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>\frac14(1+\sqrt2)\pi\approx 1.896</m>
            </p>
          </li>

          <li>
            <p>
              <m>\frac1{6}(1+2\sqrt{2})\pi\approx 2.005</m>
            </p>
          </li>

          <li>
            <p>
              <m>2</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{4} \sqrt x\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>2+\sqrt2+\sqrt3\approx 5.15</m>
            </p>
          </li>

          <li>
            <p>
              <m>2/3(3+\sqrt2+2\sqrt3)\approx 5.25</m>
            </p>
          </li>

          <li>
            <p>
              <m>16/3\approx 5.33</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{3} (x^3+2x^2-5x+7)\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>38.5781</m>
            </p>
          </li>

          <li>
            <p>
              <m>147/4\approx 36.75</m>
            </p>
          </li>

          <li>
            <p>
              <m>147/4\approx 36.75</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{1} x^4\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>0.2207</m>
            </p>
          </li>

          <li>
            <p>
              <m>0.2005</m>
            </p>
          </li>

          <li>
            <p>
              <m>1/5</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{2\pi} \cos x\ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>0</m>
            </p>
          </li>

          <li>
            <p>
              <m>0</m>
            </p>
          </li>

          <li>
            <p>
              <m>0</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{-3}^{3} \sqrt{9-x^2} \ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>9/2(1+\sqrt3)\approx 12.294</m>
            </p>
          </li>

          <li>
            <p>
              <m>3+6\sqrt3\approx 13.392</m>
            </p>
          </li>

          <li>
            <p>
              <m>9\pi/2\approx 14.137</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <p>
      In the following exercises,
      approximate the definite integral with the Trapezoidal Rule and Simpson's Rule,
      with <m>n=6</m>.
    </p>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{1} \cos \big(x^2\big) \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>0.9006</m>
        </p>

        <p>
          Simpson's Rule: <m>0.90452</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{-1}^{1} e^{x^2} \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>3.0241</m>
        </p>

        <p>
          Simpson's Rule: <m>2.9315</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{5} \sqrt{x^2+1} \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>13.9604</m>
        </p>

        <p>
          Simpson's Rule: <m>13.9066</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{\pi} x\sin x \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>3.0695</m>
        </p>

        <p>
          Simpson's Rule: <m>3.14295</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{\pi/2} \sqrt{\cos x} \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>1.1703</m>
        </p>

        <p>
          Simpson's Rule: <m>1.1873</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{1}^{4} \ln x \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>2.52971</m>
        </p>

        <p>
          Simpson's Rule: <m>2.5447</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{-1}^{1} \frac{1}{\sin x+2} \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>1.0803</m>
        </p>

        <p>
          Simpson's Rule: <m>1.077</m>
        </p>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{6} \frac{1}{\sin x+2} \ dx</m>
        </p>
      </statement>
      <answer>
        <p>
          Trapezoidal Rule: <m>3.5472</m>
        </p>

        <p>
          Simpson's Rule: <m>3.6133</m>
        </p>
      </answer>
    </exercise>

    <p>
      In the following exercises,
      find <m>n</m> such that the error in approximating the given definite integral is less than <m>0.0001</m> when using:

      <ol>
        <li>
          <title>(a)</title>
          <p>
            the Trapezoidal Rule
          </p>
        </li>

        <li>
          <title>(b)</title>
          <p>
            Simpson's Rule
          </p>
        </li>
      </ol>
    </p>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{\pi} \sin x \ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>n=161</m> (using <m>\max\big(\fpp(x)\big)=1</m>)
            </p>
          </li>

          <li>
            <p>
              <m>n=12</m> (using <m>\max\big(f\,^{(4)}(x)\big)=1</m>)
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{1}^{4} \frac{1}{\sqrt x} \ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>n=150</m> (using <m>\max\big(\fpp(x)\big)=1</m>)
            </p>
          </li>

          <li>
            <p>
              <m>n=18</m> (using <m>\max\big(f\,^{(4)}(x)\big)=7</m>)
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{\pi} \cos \big(x^2\big) \ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>n=1004</m> (using <m>\max\big(\fpp(x)\big)=39</m>)
            </p>
          </li>

          <li>
            <p>
              <m>n=62</m> (using <m>\max\big(f\,^{(4)}(x)\big)=800</m>)
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <p>
          <m>\ds \int_{0}^{5} x^4 \ dx</m>
        </p>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              <m>n=5591</m> (using <m>\max\big(\fpp(x)\big)=300</m>)
            </p>
          </li>

          <li>
            <p>
              <m>n=46</m> (using <m>\max\big(f\,^{(4)}(x)\big)=24</m>)
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <p>
      In the following exercises, a region is given.
      Find the area of the region using Simpson's Rule:

      <ol>
        <li>
          <title>(a)</title>
          <p>
            where the measurements are in centimeters,
            taken in 1 cm increments, and
          </p>
        </li>

        <li>
          <title>(b)</title>
          <p>
            where the measurements are in hundreds of yards,
            taken in 100 yd increments.
          </p>
        </li>
      </ol>
    </p>

    <exercise>
      <statement>
        <sidebyside>
          <img src="figures/fig05_05_ex_01"/>
        </sidebyside>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              Area is <m>30.8667</m> cm<m>^2</m>.
            </p>
          </li>

          <li>
            <p>
              Area is <m>308,667</m> yd<m>^2</m>.
            </p>
          </li>
        </ol>
      </answer>
    </exercise>

    <exercise>
      <statement>
        <sidebyside>
          <img src="figures/fig05_05_ex_02"/>
        </sidebyside>
      </statement>
      <answer>
        <ol>
          <li>
            <p>
              Area is 25.0667 cm<m>^2</m>
            </p>
          </li>

          <li>
            <p>
              Area is 250,667 yd<m>^2</m>
            </p>
          </li>
        </ol>
      </answer>
    </exercise>
  </subsection>
</section>

